

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Code Documentation &mdash; Particle Phase Space  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Supported particles" href="supported_particles.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Particle Phase Space
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="phase_space_format.html">Phase Space Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="supported_particles.html">Supported particles</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Code Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-ParticlePhaseSpace.DataLoaders">Data Loaders</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ParticlePhaseSpace.DataLoaders.Load_PandasData"><code class="docutils literal notranslate"><span class="pre">Load_PandasData</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ParticlePhaseSpace.DataLoaders.Load_TibarayData"><code class="docutils literal notranslate"><span class="pre">Load_TibarayData</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ParticlePhaseSpace.DataLoaders.Load_TopasData"><code class="docutils literal notranslate"><span class="pre">Load_TopasData</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-ParticlePhaseSpace._ParticlePhaseSpace">Particle Phase Space</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace"><code class="docutils literal notranslate"><span class="pre">PhaseSpace</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.assess_density_versus_r"><code class="docutils literal notranslate"><span class="pre">PhaseSpace.assess_density_versus_r()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.calculate_twiss_parameters"><code class="docutils literal notranslate"><span class="pre">PhaseSpace.calculate_twiss_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.fill_beta_and_gamma"><code class="docutils literal notranslate"><span class="pre">PhaseSpace.fill_beta_and_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.fill_direction_cosines"><code class="docutils literal notranslate"><span class="pre">PhaseSpace.fill_direction_cosines()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.fill_kinetic_E"><code class="docutils literal notranslate"><span class="pre">PhaseSpace.fill_kinetic_E()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.fill_rest_mass"><code class="docutils literal notranslate"><span class="pre">PhaseSpace.fill_rest_mass()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.fill_velocity"><code class="docutils literal notranslate"><span class="pre">PhaseSpace.fill_velocity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.filter_by_time"><code class="docutils literal notranslate"><span class="pre">PhaseSpace.filter_by_time()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.get_downsampled_phase_space"><code class="docutils literal notranslate"><span class="pre">PhaseSpace.get_downsampled_phase_space()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.plot_beam_intensity"><code class="docutils literal notranslate"><span class="pre">PhaseSpace.plot_beam_intensity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.plot_energy_histogram"><code class="docutils literal notranslate"><span class="pre">PhaseSpace.plot_energy_histogram()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.plot_n_particles_v_time"><code class="docutils literal notranslate"><span class="pre">PhaseSpace.plot_n_particles_v_time()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.plot_particle_positions"><code class="docutils literal notranslate"><span class="pre">PhaseSpace.plot_particle_positions()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.plot_position_histogram"><code class="docutils literal notranslate"><span class="pre">PhaseSpace.plot_position_histogram()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.plot_transverse_trace_space_scatter"><code class="docutils literal notranslate"><span class="pre">PhaseSpace.plot_transverse_trace_space_scatter()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.print_energy_stats"><code class="docutils literal notranslate"><span class="pre">PhaseSpace.print_energy_stats()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.print_twiss_parameters"><code class="docutils literal notranslate"><span class="pre">PhaseSpace.print_twiss_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.project_particles"><code class="docutils literal notranslate"><span class="pre">PhaseSpace.project_particles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.reset_phase_space"><code class="docutils literal notranslate"><span class="pre">PhaseSpace.reset_phase_space()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-ParticlePhaseSpace.DataExporters">Data Exporters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ParticlePhaseSpace.DataExporters.Topas_Exporter"><code class="docutils literal notranslate"><span class="pre">Topas_Exporter</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Particle Phase Space</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Code Documentation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/code_docs.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="code-documentation">
<h1>Code Documentation<a class="headerlink" href="#code-documentation" title="Permalink to this heading">¶</a></h1>
<p>This page shows the documentation generated by sphinx automatically scanning our source code</p>
<section id="module-ParticlePhaseSpace.DataLoaders">
<span id="data-loaders"></span><h2>Data Loaders<a class="headerlink" href="#module-ParticlePhaseSpace.DataLoaders" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ParticlePhaseSpace.DataLoaders.Load_PandasData">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ParticlePhaseSpace.DataLoaders.</span></span><span class="sig-name descname"><span class="pre">Load_PandasData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">particle_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace.DataLoaders.Load_PandasData" title="Permalink to this definition">¶</a></dt>
<dd><p>loads in pandas data of the format. This is used internally by ParticlePhaseSpace, and can also be used
externally in cases where it is not desired to write a dedicated new data loader:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ParticlePhaseSpace</span> <span class="kn">import</span> <span class="n">DataLoaders</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">demo_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span><span class="s1">&#39;x [mm]&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
     <span class="s1">&#39;y [mm]&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
     <span class="s1">&#39;z [mm]&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
     <span class="s1">&#39;px [MeV/c]&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
     <span class="s1">&#39;py [MeV/c]&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
     <span class="s1">&#39;pz [MeV/c]&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
     <span class="s1">&#39;particle type [pdg_code]&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
     <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
     <span class="s1">&#39;particle id&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
     <span class="s1">&#39;time [ps]&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">DataLoaders</span><span class="o">.</span><span class="n">Load_PandasData</span><span class="p">(</span><span class="n">demo_data</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ParticlePhaseSpace.DataLoaders.Load_TibarayData">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ParticlePhaseSpace.DataLoaders.</span></span><span class="sig-name descname"><span class="pre">Load_TibarayData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">particle_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace.DataLoaders.Load_TibarayData" title="Permalink to this definition">¶</a></dt>
<dd><p>Load ASCII data from tibaray of format
<cite>x y z rxy Bx By Bz G t m q nmacro rmacro ID</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data_loc</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;../tests/test_data/tibaray_test.dat&#39;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">DataLoaders</span><span class="o">.</span><span class="n">Load_TibarayData</span><span class="p">(</span><span class="n">data_loc</span><span class="p">,</span> <span class="n">particle_type</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">PS</span> <span class="o">=</span> <span class="n">PhaseSpace</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ParticlePhaseSpace.DataLoaders.Load_TopasData">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ParticlePhaseSpace.DataLoaders.</span></span><span class="sig-name descname"><span class="pre">Load_TopasData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">particle_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace.DataLoaders.Load_TopasData" title="Permalink to this definition">¶</a></dt>
<dd><p>DataLoader for <a class="reference external" href="https://topas.readthedocs.io/en/latest/">Topas</a> data.
This data loader will read in both ascii and binary topas phase space (phsp) files.
At present, we do not handle time or particle-id fields which may or may not be present in topas data.
Behind the scenes, it relies on <a class="reference external" href="https://github.com/davidchall/topas2numpy">topas2numpy</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ParticlePhaseSpace</span> <span class="kn">import</span> <span class="n">DataLoaders</span>
<span class="kn">from</span> <span class="nn">ParticlePhaseSpace</span> <span class="kn">import</span> <span class="n">PhaseSpace</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="n">data_loc</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;../tests/test_data/coll_PhaseSpace_xAng_0.00_yAng_0.00_angular_error_0.0.phsp&#39;</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">DataLoaders</span><span class="o">.</span><span class="n">Load_TopasData</span><span class="p">(</span><span class="n">data_loc</span><span class="p">)</span>
<span class="n">PS</span> <span class="o">=</span> <span class="n">PhaseSpace</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-ParticlePhaseSpace._ParticlePhaseSpace">
<span id="particle-phase-space"></span><h2>Particle Phase Space<a class="headerlink" href="#module-ParticlePhaseSpace._ParticlePhaseSpace" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ParticlePhaseSpace._ParticlePhaseSpace.</span></span><span class="sig-name descname"><span class="pre">PhaseSpace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_loader</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace" title="Permalink to this definition">¶</a></dt>
<dd><p>This class holds phase space data in  a pandas dataframe, and allowed users to utilise common libraries for
plotting and analysis. It accepts data from any <a class="reference external" href="https://bwheelz36.github.io/ParticlePhaseSpace/code_docs.html#module-ParticlePhaseSpace.DataLoaders">DataLoader</a>
Basic use is documented <a class="reference external" href="https://bwheelz36.github.io/ParticlePhaseSpace/basic_example.html">here</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_loader</strong> (<em>_DataLoadersBase</em>) – an instance of ParticlePhaseSpace.DataLoaders._DataLoadersBase</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.assess_density_versus_r">
<span class="sig-name descname"><span class="pre">assess_density_versus_r</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Rvals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beam_direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'z'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.assess_density_versus_r" title="Permalink to this definition">¶</a></dt>
<dd><p>Assess how many particles are in a given radius</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Rvals</strong> – list of rvals to assess in mm, e.g. np.linspace(0, 2, 21)</p></li>
<li><p><strong>verbose</strong> – prints data to screen if True</p></li>
<li><p><strong>beam_direction</strong> (<em>str</em><em>, </em><em>optional</em>) – main direction in which beam is travelling. ‘x’, ‘y’, or ‘z’ (default)</p></li>
</ul>
</dd>
<dt class="field-even">Return density_data<span class="colon">:</span></dt>
<dd class="field-even"><p>a dataframe containing the roi vals and the proportion of particles inside</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.calculate_twiss_parameters">
<span class="sig-name descname"><span class="pre">calculate_twiss_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beam_direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'z'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.calculate_twiss_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the RMS <a class="reference external" href="https://en.wikipedia.org/wiki/Courant%E2%80%93Snyder_parameters">twiss parameters</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>beam_direction</strong> (<em>str</em><em>, </em><em>optional</em>) – main direction in which beam is travelling. ‘x’, ‘y’, or ‘z’ (default)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.fill_beta_and_gamma">
<span class="sig-name descname"><span class="pre">fill_beta_and_gamma</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.fill_beta_and_gamma" title="Permalink to this definition">¶</a></dt>
<dd><p>add the relatavistic beta and gamma factors into self._ps_data</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.fill_direction_cosines">
<span class="sig-name descname"><span class="pre">fill_direction_cosines</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.fill_direction_cosines" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate direction cosines, which are required for topas import:
U (direction cosine of momentum with respect to X)
V (direction cosine of momentum with respect to Y)
:return:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.fill_kinetic_E">
<span class="sig-name descname"><span class="pre">fill_kinetic_E</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.fill_kinetic_E" title="Permalink to this definition">¶</a></dt>
<dd><p>adds kinetic energy into self._ps_data</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.fill_rest_mass">
<span class="sig-name descname"><span class="pre">fill_rest_mass</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.fill_rest_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>add rest mass data to self._ps_data
:return:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.fill_velocity">
<span class="sig-name descname"><span class="pre">fill_velocity</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.fill_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>add velocities into self._ps_data</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.filter_by_time">
<span class="sig-name descname"><span class="pre">filter_by_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_finish</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.filter_by_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a new PhaseSpace which only contains particles inside t_start and t_finish (inclusive).
t_start and t_finish should be specfied in ps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t_start</strong> (<em>float</em>) – particles with t&lt;t_start are removed.</p></li>
<li><p><strong>t_finish</strong> (<em>float</em>) – particleswith t&gt;t_finish are removed</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new_instance: a new phase space object with data filtered by time</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.get_downsampled_phase_space">
<span class="sig-name descname"><span class="pre">get_downsampled_phase_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">downsample_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.get_downsampled_phase_space" title="Permalink to this definition">¶</a></dt>
<dd><p>return a new phase space object which randomlt samples from the larger phase space.
the new phase space has size ‘original data/downsample_factor’. the data is shuffled
before being randomly sampled.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>downsample_factor</strong> (<em>int</em>) – the factor to downsample the phase space by</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.plot_beam_intensity">
<span class="sig-name descname"><span class="pre">plot_beam_intensity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beam_direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'z'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'intensity'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.plot_beam_intensity" title="Permalink to this definition">¶</a></dt>
<dd><p>This is alternative to plot_particle_positions(weight_position_plot=True); rather than a scatter plot of every particle, an
image is formed by assigning particles to bins over a 2D grid. This is faster than generating a gaussian kde of intensity.
In addition, this also allows to accumulate over energy as well as intensity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>beam_direction</strong> (<em>str</em><em>, </em><em>optional</em>) – the direction the beam is travelling in. “x”, “y”, or “z” (default)</p></li>
<li><p><strong>xlim</strong> (<em>list</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – set the xlim for all plots, e.g. [-2,2]</p></li>
<li><p><strong>ylim</strong> (<em>list</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – set the ylim for all plots, e.g. [-2,2]</p></li>
<li><p><strong>quantity</strong> (<em>str</em>) – quantity to accumulate; either ‘intensity’ or ‘energy</p></li>
<li><p><strong>grid</strong> (<em>bool</em>) – turns grid on/off</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.plot_energy_histogram">
<span class="sig-name descname"><span class="pre">plot_energy_histogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.plot_energy_histogram" title="Permalink to this definition">¶</a></dt>
<dd><p>generate a histogram plot of paritcle energies.
Each particle spcies present in the phase space is overlaid  on the same plot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_bins</strong> – number of bins in histogram</p></li>
<li><p><strong>title</strong> – title of histogram</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.plot_n_particles_v_time">
<span class="sig-name descname"><span class="pre">plot_n_particles_v_time</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.plot_n_particles_v_time" title="Permalink to this definition">¶</a></dt>
<dd><p>basic plot of number of particles versus time; useful for quickly seperating out different bunches
of electrons such that you can apply the ‘filter_by_time’ method</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.plot_particle_positions">
<span class="sig-name descname"><span class="pre">plot_particle_positions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beam_direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'z'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_position_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.plot_particle_positions" title="Permalink to this definition">¶</a></dt>
<dd><p>produce a scatter plot of particle positions.
one plot is produced for each unique species.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>beam_direction</strong> (<em>str</em><em>, </em><em>optional</em>) – the direction the beam is travelling in. “x”, “y”, or “z” (default)</p></li>
<li><p><strong>weight_position_plot</strong> (<em>bool</em>) – if True, a gaussian kde is used to weight the particle
positions. This can produce very informative and useful plots, but also be very slow.
If it is slow, you could try downsampling the phase space first using get_downsampled_phase_space</p></li>
<li><p><strong>xlim</strong> (<em>list</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – set the xlim for all plots, e.g. [-2,2]</p></li>
<li><p><strong>ylim</strong> (<em>list</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – set the ylim for all plots, e.g. [-2,2]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.plot_position_histogram">
<span class="sig-name descname"><span class="pre">plot_position_histogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.plot_position_histogram" title="Permalink to this definition">¶</a></dt>
<dd><p>plot a histogram of particle positions in x, y, z.
a new histogram is generated for each particle species.
histograms are overlaid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_bins</strong> – number of bins in histogram</p></li>
<li><p><strong>alpha</strong> – controls transparency of each histogram.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.plot_transverse_trace_space_scatter">
<span class="sig-name descname"><span class="pre">plot_transverse_trace_space_scatter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beam_direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'z'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_twiss_ellipse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.plot_transverse_trace_space_scatter" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a scatter plot of x versus x’=px/pz and y versus y’=py/pz (these definitions are for
beam_direction=’z’)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>beam_direction</strong> (<em>str</em><em>, </em><em>optional</em>) – main direction in which beam is travelling. ‘x’, ‘y’, or ‘z’ (default)</p></li>
<li><p><strong>plot_twiss_ellipse</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True, will overlay the RMS twiss ellipse onto the trace space</p></li>
<li><p><strong>xlim</strong> (<em>list</em><em>, </em><em>optional</em>) – set xlim, e.g. [-2,2]</p></li>
<li><p><strong>ylim</strong> (<em>list</em><em>, </em><em>optional</em>) – set ylim, e.g. [-2,2]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.print_energy_stats">
<span class="sig-name descname"><span class="pre">print_energy_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.print_energy_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints a sumary of the phase space to the screen.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.print_twiss_parameters">
<span class="sig-name descname"><span class="pre">print_twiss_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beam_direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'z'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.print_twiss_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>prints the twiss parameters if they exist
they are always printed to the screen.
if filename is specified, they are also saved to file as json</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_name</strong> – filename to write twiss data to. should be absolute
path to an existing directory</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.project_particles">
<span class="sig-name descname"><span class="pre">project_particles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beam_direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'z'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_place</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.project_particles" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the positions of each particle by projecting it forward/back by distance.</p>
<p>This serves as a crude approximation to more advanced particle transport codes
and represents where the particles would end up in the absence of any forces or interactions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>direction</strong> – the direction to project in. ‘x’, ‘y’, or ‘z’</p></li>
<li><p><strong>distance</strong> – how far to project in mm</p></li>
<li><p><strong>in_place</strong> – if True, the existing PhaseSpace object has its data updated. if False,
a new PhaseSpace object is returned</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new_instance: if in_place = False, a new PhaseSpace object is returned</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.reset_phase_space">
<span class="sig-name descname"><span class="pre">reset_phase_space</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.reset_phase_space" title="Permalink to this definition">¶</a></dt>
<dd><p>reduce self._ps_data to only the required columns
delete any other derived quantities such as twiss parameters
this can be called whenever you want to reduce the memory footprint
It is also called internally whenever the user changes the data in ps_data</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-ParticlePhaseSpace.DataExporters">
<span id="data-exporters"></span><h2>Data Exporters<a class="headerlink" href="#module-ParticlePhaseSpace.DataExporters" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ParticlePhaseSpace.DataExporters.Topas_Exporter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ParticlePhaseSpace.DataExporters.</span></span><span class="sig-name descname"><span class="pre">Topas_Exporter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">PhaseSpaceInstance:</span> <span class="pre">~ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_location:</span> <span class="pre">(&lt;class</span> <span class="pre">'str'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'pathlib.Path'&gt;)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name:</span> <span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace.DataExporters.Topas_Exporter" title="Permalink to this definition">¶</a></dt>
<dd><p>output the phase space to <a class="reference external" href="https://topas.readthedocs.io/en/latest/parameters/source/phasespace.html">topas ascii format</a>.</p>
<dl class="simple">
<dt>Note:</dt><dd><ul class="simple">
<li><p>we do not handle any time features</p></li>
<li><p>every particle in the phase space is flagged as being a new history.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="supported_particles.html" class="btn btn-neutral float-left" title="Supported particles" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022, Brendan Whelan.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>